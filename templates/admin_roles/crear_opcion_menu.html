{% extends "base.html" %}

{% block title %}Nueva opción de menú{% endblock %}
{% block page_title %}Nueva opción de menú{% endblock %}

{% block content %}
<div class="container-fluid">
    <div class="card">
        <div class="card-header">
            <h5 class="mb-0">Registrar vista y asignar roles</h5>
        </div>
        <div class="card-body">
            <p class="text-muted">
                Crea una opción de menú para una vista (URL). El <strong>Nombre de URL</strong> debe coincidir
                exactamente con el que usa Django (ej: <code>lista_lotes</code>, <code>pedidos:reporte_items_no_surtidos</code>).
                Así podrás definir qué roles tienen acceso sin modificar código.
            </p>
            <form method="post">
                {% csrf_token %}
                <div class="row mb-3">
                    <div class="col-md-6">
                        <label for="menu_item" class="form-label">Identificador de menú <span class="text-danger">*</span></label>
                        <input type="text" name="menu_item" id="menu_item" class="form-control" required
                               placeholder="ej: reporte_items_no_surtidos" maxlength="100">
                        <small class="text-muted">Único. Sin espacios (ej: reporte_pedidos_sin_existencia).</small>
                    </div>
                    <div class="col-md-6">
                        <label for="nombre_mostrado" class="form-label">Nombre mostrado <span class="text-danger">*</span></label>
                        <input type="text" name="nombre_mostrado" id="nombre_mostrado" class="form-control" required
                               placeholder="ej: Reporte Items No Surtidos" maxlength="100">
                    </div>
                </div>
                <div class="row mb-3">
                    <div class="col-md-8">
                        <label for="url_name" class="form-label">Nombre de URL (url_name) <span class="text-danger">*</span></label>
                        <input type="text" name="url_name" id="url_name" class="form-control" required
                               placeholder="ej: lista_lotes o pedidos:reporte_items_no_surtidos" maxlength="100">
                        <small class="text-muted">Con namespace si aplica: <code>app:nombre_vista</code>.</small>
                    </div>
                    <div class="col-md-4">
                        <label for="icono" class="form-label">Icono (Font Awesome)</label>
                        <input type="text" name="icono" id="icono" class="form-control" value="fas fa-circle"
                               placeholder="fas fa-clipboard-list" maxlength="50">
                    </div>
                </div>
                <div class="row mb-3">
                    <div class="col-md-3">
                        <label for="orden" class="form-label">Orden</label>
                        <input type="number" name="orden" id="orden" class="form-control" value="0" min="0">
                    </div>
                    <div class="col-md-9 d-flex align-items-end">
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" name="activo" id="activo" checked>
                            <label class="form-check-label" for="activo">Opción activa</label>
                        </div>
                    </div>
                </div>
                <div class="mb-3">
                    <label class="form-label">Roles que pueden acceder a esta vista</label>
                    <div class="row">
                        {% for rol in roles %}
                        <div class="col-md-4 col-lg-3">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" name="roles" value="{{ rol.id }}" id="rol_{{ rol.id }}">
                                <label class="form-check-label" for="rol_{{ rol.id }}">{{ rol.name }}</label>
                            </div>
                        </div>
                        {% empty %}
                        <div class="col-12"><p class="text-muted">No hay roles. Crea grupos en Django Admin → Grupos.</p></div>
                        {% endfor %}
                    </div>
                </div>
                <hr>
                <button type="submit" class="btn btn-primary"><i class="fas fa-save me-2"></i>Crear opción</button>
                <a href="{% url 'admin_roles:lista_opciones_menu' %}" class="btn btn-secondary">Cancelar</a>
            </form>
        </div>
    </div>
</div>
{% endblock %}
